#pragma once

#include <raylib.h>
#include <vector>

namespace BlockModel
{
    enum class Direction
    {
        None =      0,
        Forward =   1 << 0,
        Backward =  1 << 1,
        Left =      1 << 2,
        Right =     1 << 3,
        Up =        1 << 4,
        Down =      1 << 5,
    };

    struct BlockFace
    {
        Direction facingDirection = Direction::None; // Facing direction of the block face
        int occlusionNeighbors = 0; // Bitmask of neighboring blocks that have to be opaque to cull this face
        int triangleCount = 0;

        std::vector<std::array<float, 8>> vertices {};
    };

    struct Model
    {
        std::vector<BlockFace> faces;

        // Useful info for generating opaqueMesh
        int triangleCount;
    };

    static const Model None = {};

    static const Model FullBlock =
    {{
        {
            Direction::Backward,
            static_cast<int>(Direction::Backward),
            2,
            {
                {1, 1, 0,   0, 0, 1,   0, 0},
                {1, 0, 0,   0, 0, 1,   0, 1},
                {0, 1, 0,   0, 0, 1,   1, 0},
                {0, 1, 0,   0, 0, 1,   1, 0},
                {1, 0, 0,   0, 0, 1,   0, 1},
                {0, 0, 0,   0, 0, 1,   1, 1}
            },
        },
        {
            Direction::Forward,
            static_cast<int>(Direction::Forward),
            2,
            {
                {0, 0, 1,   0, 0, 1,    0, 1},
                {1, 0, 1,   0, 0, 1,    1, 1},
                {0, 1, 1,   0, 0, 1,    0, 0},
                {0, 1, 1,   0, 0, 1,    0, 0},
                {1, 0, 1,   0, 0, 1,    1, 1},
                {1, 1, 1,   0, 0, 1,    1, 0}
            },
        },
        {
            Direction::Left,
            static_cast<int>(Direction::Left),
            2,
            {
                {0, 0, 0,   -1, 0, 0,    0, 1},
                {0, 0, 1,   -1, 0, 0,    1, 1},
                {0, 1, 0,   -1, 0, 0,    0, 0},
                {0, 1, 0,   -1, 0, 0,    0, 0},
                {0, 0, 1,   -1, 0, 0,    1, 1},
                {0, 1, 1,   -1, 0, 0,    1, 0}
            },
        },
        {
            Direction::Right,
            static_cast<int>(Direction::Right),
            2,
            {
                {1, 1, 1,   1, 0, 0,    0, 0},
                {1, 0, 1,   1, 0, 0,    0, 1},
                {1, 1, 0,   1, 0, 0,    1, 0},
                {1, 1, 0,   1, 0, 0,    1, 0},
                {1, 0, 1,   1, 0, 0,    0, 1},
                {1, 0, 0,   1, 0, 0,    1, 1}
            },
        },
        {
            Direction::Up,
            static_cast<int>(Direction::Up),
            2,
            {
                {0, 1, 0,   0, 1, 0,    1, 1},
                {0, 1, 1,   0, 1, 0,    1, 0},
                {1, 1, 0,   0, 1, 0,    0, 1},
                {1, 1, 0,   0, 1, 0,    0, 1},
                {0, 1, 1,   0, 1, 0,    1, 0},
                {1, 1, 1,   0, 1, 0,    0, 0}
            },
        },
        {
            Direction::Down,
            static_cast<int>(Direction::Down),
            2,
            {
                {1, 0, 1,   0, -1, 0,    0, 1},
                {0, 0, 1,   0, -1, 0,    1, 1},
                {1, 0, 0,   0, -1, 0,    0, 0},
                {1, 0, 0,   0, -1, 0,    0, 0},
                {0, 0, 1,   0, -1, 0,    1, 1},
                {0, 0, 0,   0, -1, 0,    1, 0}
            },
        },
    },12 };

    static const Model Decal =
    {{
        {
            Direction::None,
            0,
            2,
            {
                {0.85355339059, 1, 0.85355339059,   0.7071067811810678118, 0, -0.7071067811810678118,   0, 0},
                {0.85355339059, 0, 0.85355339059,   0.7071067811810678118, 0, -0.7071067811810678118,   0, 1},
                {0.1464466094, 1, 0.1464466094,   0.7071067811810678118, 0, -0.7071067811810678118,   1, 0},
                {0.1464466094, 1, 0.1464466094,   0.7071067811810678118, 0, -0.7071067811810678118,   1, 0},
                {0.85355339059, 0, 0.85355339059,   0.7071067811810678118, 0, -0.7071067811810678118,   0, 1},
                {0.1464466094, 0, 0.1464466094,   0.7071067811810678118, 0, -0.7071067811810678118,   1, 1}
            },
        },
        {
            Direction::None,
            0,
            2,
            {
                {0.1464466094, 0, 0.1464466094,   -0.70710678118, 0, 0.70710678118,   0, 1},
                {0.85355339059, 0, 0.85355339059,   -0.70710678118, 0, 0.70710678118,   1, 1},
                {0.1464466094, 1, 0.1464466094,   -0.70710678118, 0, 0.70710678118,   0, 0},
                {0.1464466094, 1, 0.1464466094,   -0.70710678118, 0, 0.70710678118,   0, 0},
                {0.85355339059, 0, 0.85355339059,   -0.70710678118, 0, 0.70710678118,   1, 1},
                {0.85355339059, 1, 0.85355339059,   -0.70710678118, 0, 0.70710678118,   1, 0}
            },
        },
        {
            Direction::None,
            0,
            2,
            {
                {0.1464466094, 1, 0.85355339059,   0.70710678118, 0, 0.70710678118,   0, 0},
                {0.1464466094, 0, 0.85355339059,   0.70710678118, 0, 0.70710678118,   0, 1},
                {0.85355339059, 1, 0.1464466094,   0.70710678118, 0, 0.70710678118,   1, 0},
                {0.85355339059, 1, 0.1464466094,   0.70710678118, 0, 0.70710678118,   1, 0},
                {0.1464466094, 0, 0.85355339059,   0.70710678118, 0, 0.70710678118,   0, 1},
                {0.85355339059, 0, 0.1464466094,   0.70710678118, 0, 0.70710678118,   1, 1}
            },
        },
        {
            Direction::None,
            0,
            2,
            {
                {0.85355339059, 0, 0.1464466094,   -0.70710678118, 0, -0.70710678118,   0, 1},
                {0.1464466094, 0, 0.85355339059,   -0.70710678118, 0, -0.70710678118,   1, 1},
                {0.85355339059, 1, 0.1464466094,   -0.70710678118, 0, -0.70710678118,   0, 0},
                {0.85355339059, 1, 0.1464466094,   -0.70710678118, 0, -0.70710678118,   0, 0},
                {0.1464466094, 0, 0.85355339059,   -0.70710678118, 0, -0.70710678118,   1, 1},
                {0.1464466094, 1, 0.85355339059,   -0.70710678118, 0, -0.70710678118,   1, 0}
            },
        }
    },8 };
}